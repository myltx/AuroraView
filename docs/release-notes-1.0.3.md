# AuroraView 1.0.3 – 使用说明页与修图筛选体验优化

> 本文档记录 1.0.3 相对于 1.0.2 的增量改动，聚焦于「使用说明入口」与「修图筛选」的体验细节优化。

---

## 1. 新增：内置使用说明页（Help）

### 1.1 应用内 Help 覆盖层

- 在 `Viewer.vue` 中新增内置使用说明覆盖层：
  - 以浮层形式在当前窗口打开，不会跳转到浏览器；
  - 内容包含：
    - 快速开始（打开目录、浏览缩略图、双击大图等）；
    - 侧边栏各分组说明（收藏 / 星级 / 外接存储 / 自定义目录等）；
    - 修图状态（PSD + RAW 分组、已修/未修角标与筛选规则）；
    - 外部应用打开（右键菜单 + 大图工具条）；
    - 常用快捷键一览；
    - 引导阅读更详细的 `docs/UserGuide.md` 与 `release-notes`。
- 交互方式：
  - 点击右上角关闭按钮或背景区域可关闭 Help；
  - 在 Help 打开时仍保留当前目录、选中状态等浏览上下文。

### 1.2 菜单栏入口与快捷键

- 主菜单栏新增 Help 入口：
  - 菜单路径：`帮助 → 使用说明`；
  - 快捷键：
    - macOS：`Cmd + /`；
    - Windows / Linux：`Ctrl + /`。
- 选择该菜单项时，会通过 `APP_ACTION: open-help` 通知渲染层，显示使用说明覆盖层。
- 菜单中「项目文档」链接更新为当前仓库地址：`https://github.com/myltx/AuroraView`。

---

## 2. 修图筛选（已修/未修/全部）体验优化

> 1.0.2 中已经增加了「修图筛选」下拉与 PSD/RAW 分组逻辑，本次版本主要优化边界行为与交互稳定性。

### 2.1 目录切换时自动重置为“全部”

- 问题：在 1.0.2 中，如果在某个目录选择了“已修/未修”筛选，然后切换到另一个目录，可能出现：
  - 新目录实际有图片，但仍受上一目录筛选影响而被过滤掉；
  - 用户误以为新目录是空的。
- 1.0.3 行为：
  - 每次切换目录时，`editStatusFilter` 自动重置为 `"all"`（全部）；
  - 修图筛选下拉菜单也会同步回到「全部」状态；
  - 避免跨目录的筛选残留影响用户判断。

### 2.2 没有已修/未修图片时仍可操作筛选

- 1.0.2 的边界场景：
  - 当选择“已修”筛选，而当前目录没有任何已修分组时：
    - 缩略图列表为空；
    - 由于筛选按钮基于“当前展示数量”判断，有可能筛完后按钮也被隐藏，用户无法切回“全部”。
- 1.0.3 调整：
  - 新增 `hasAnySourceImages` 作为「目录是否有源图片」的判定；
  - 「修图筛选」按钮显示条件改为：
    - 目录中存在任何图片源（`hasAnySourceImages === true`），而非当前筛选结果非空；
  - 这样即使在“已修/未修”筛选下结果为空，下拉按钮仍然存在，用户可以随时切回“全部图片」。

---

## 3. 使用说明文档与 Help 页面的关系

### 3.1 docs/UserGuide.md（用户说明文档）

- 新增用户向文档：`docs/UserGuide.md`：
  - 面向终端用户，系统梳理 AuroraView 的：
    - 快速上手步骤；
    - 目录/侧边栏的结构与用途；
    - 修图工作流（PSD + RAW 标记、角标与筛选）；
    - 外部应用打开与扩展名绑定；
    - 常用快捷键列表；
    - 自动更新的简要说明。
- 建议：
  - 安装包中保留该文档；
  - 可在未来 README / 官网中复用相关内容。

### 3.2 Viewer 内 Help 页

- Help 覆盖层为 `UserGuide.md` 的“轻量版”：
  - 内容更加精简，避免在应用界面内展示过长文档；
  - 强调实际操作路径与快捷键，方便新用户快速上手。
- 若需要更详细内容，可在 Help 中引导用户阅读安装包中的完整文档。

---

## 4. 开发者向调整（类型与构建稳定性）

- 为 PSD 相关类型补充了显式声明，避免在严格 TS 配置下类型找不到（`PsdGroup` 等）：
  - 新增 `packages/renderer/src/types/psd.ts`，统一声明：
    - `PsdMetadata`、`PsdVariant`、`PsdGroup`；
  - 渲染层通过 `import type { PsdGroup }` 获取类型，避免全局声明混乱。
- 清理了未使用的变量与函数，保证在 `strict + noUnusedLocals` 下编译通过：
  - 移除未再使用的 `themeOptions`、旧的旋转/翻转按钮逻辑；
  - 删除无用的 `handleRatingClick`（缩略图星级已移除，改由大图视图统一处理）。
- 所有改动均保持向后兼容，不影响现有自动更新与数据格式：
  - `preferences.json` 与 `psd-metadata.json` 结构与 1.0.2 保持一致；
  - 仅在渲染层增加了新的 UI 与类型辅助逻辑。

---

## 5. 升级与兼容性

- 从 1.0.2 升级到 1.0.3：
  - 无需手动迁移数据或配置；
  - 1.0.3 会在原有功能基础上提供更清晰的 Help 入口与更健壮的修图筛选行为。
- 自动更新：
  - 若已按 1.0.2 的方式配置 GitHub Releases（`zip + latest-mac.yml`），1.0.3 可直接通过自动更新下发；
  - `.dmg` 仍主要用于首次安装与手动下载，与自动更新逻辑无耦合。

> 如需要进一步扩展视频支持、时间线视图等高级功能，可参考 `docs/VideoSupportPlan.md` 中记录的规划，以 1.0.3 作为稳定基线迭代。

